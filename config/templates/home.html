{% extends "base.html" %}
{% block title %}X - すべての話題が、ここに。{% endblock %}

{% block content %}
<div class="container-fluid">
        {% if user.is_authenticated %}
        <div class="row">
                <!-- サイドバー -->
                <div class="col-2 col-md-3 border-end border-secondary">
                        <div class="position-fixed d-flex flex-column align-items-center align-items-md-end pe-3"
                                style="width: inherit; max-width: inherit;">
                                {% include "includes/_sidebar_nav.html" with user=user %}
                        </div>
                </div>

                <!-- メインコンテンツ -->
                <div class="col-10 col-md-6 min-vh-100 border-secondary px-0">
                        <!-- タブナビゲーション -->
                        <div class="border-bottom border-secondary position-fixed bg-black"
                                style="z-index: 1000; width: inherit; max-width: inherit;">
                                <div class="d-flex">
                                        <a href="?tab=recommended"
                                                class="flex-grow-1 text-center text-decoration-none py-3 {% if current_tab == 'recommended' %}border-bottom border-primary{% endif %}">
                                                <span
                                                        class="{% if current_tab == 'recommended' %}text-white fw-bold{% else %}text-secondary{% endif %}">おすすめ</span>
                                        </a>
                                        <a href="?tab=following"
                                                class="flex-grow-1 text-center text-decoration-none py-3 {% if current_tab == 'following' %}border-bottom border-primary{% endif %}">
                                                <span
                                                        class="{% if current_tab == 'following' %}text-white fw-bold{% else %}text-secondary{% endif %}">フォロー中</span>
                                        </a>
                                </div>
                        </div>
                        <!-- スペーサー (タブの高さ分) -->
                        <div style="height: 49px;"></div>

                        <!-- メインコンテンツエリア -->
                        <div>
                                <!-- 投稿フォーム -->
                                <div class="p-3 border-bottom border-secondary">
                                        <div class="d-flex">
                                                <div class="me-3">
                                                        {% if user.profile_image %}
                                                        <img src="{{ user.profile_image.url }}" class="rounded-circle"
                                                                width="48" height="48" alt="プロフィール画像">
                                                        {% else %}
                                                        <div class="rounded-circle bg-secondary"
                                                                style="width: 48px; height: 48px;"></div>
                                                        {% endif %}
                                                </div>
                                                <div class="flex-grow-1">
                                                        <textarea class="form-control bg-black text-white border-0"
                                                                rows="3" placeholder="いまどうしてる？"></textarea>
                                                        <div
                                                                class="d-flex justify-content-between align-items-center mt-2">
                                                                <div>
                                                                        <button class="btn btn-link text-primary p-1">
                                                                                <i class="bi bi-image"></i>
                                                                        </button>
                                                                </div>
                                                                <button class="btn btn-primary rounded-pill px-4">
                                                                        ポストする
                                                                </button>
                                                        </div>
                                                </div>
                                        </div>
                                </div>

                                <!-- タイムライン -->
                                <div class="tweet-list">
                                        {% for tweet in tweets %}
                                        {% include "includes/_tweet_card.html" with tweet=tweet %}
                                        {% empty %}
                                        <div class="p-3 text-center text-secondary">
                                                {% if current_tab == 'following' %}
                                                フォローしているユーザーのツイートはありません
                                                {% else %}
                                                ツイートはありません
                                                {% endif %}
                                        </div>
                                        {% endfor %}
                                </div>

                                <!-- ページネーション -->
                                {% include "includes/_pagination.html" %}
                        </div>
                </div>

                <div class="col-md-3 d-none d-md-block border-start border-secondary border-end border-secondary">
                </div>

        </div>
        {% else %}
        <!-- 未ログイン時のレイアウト -->
        {% include "includes/_landing_page.html" %}
        {% endif %}
</div>
{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css">
{% endblock %}
